<!DOCTYPE html>
<html lang="en">
<head> 
  <title></title>
  <script src="./js/jquery.min.js"></script>
  <script src="./js/site.js"></script>
</head>
<body>
	<div class="header"></div>

	<div class="container">
	<h3>
	<p style="font-size: 18px;">
	<a class="" href="index.html">Home</a>&nbsp;/&nbsp;<span class="teamname"></span>
	</p>	
	</h3> 
	</div>
  
  <div class="container">
    <h2 class="page-header teamname"></h2> 
    <div class="pagelist"></div>	

<script>
	//Revealing Module Design Pattern 
	var page = (function () {
		var init = function() {	
			var data = {};
			data["teamid"] = getQueryVariable("teamid");
			var cache = {};
			cache["teamid"] = getQueryVariable("teamid");
			
			teamnode.fetchInfo().done( function (data) {
				console.log("fetchInfo done: " + JSON.stringify(data));
				
				document.title = data.sitename;
				$('.sitename').html(data.sitename);
				$('.lead').html(data.sitewelcome);				
			});

			teamnode.fetchTeams(data).done( function (data) {
				console.log("fetchTeams done: " + JSON.stringify(data));
				var html = "";
				var team = data.teams[0];
				
				$('.teamname').html(team.name);		
				
				cache['teambackground'] = team.background;
				cache['teamfontcolor'] = team.fontcolor;
				
			}).then(				
			
				teamnode.fetchPages(data).done( function (data) {
					console.log("fetchPages in done: " + JSON.stringify(data));
					var html = "";
					
					$.each(data.pages, function (i, value) {
						//console.log('value: ' + JSON.stringify(value));
						html  +=  
							'<div class="col-sm-5">' +
							'    <p>' +
							'      <a id="';html+=value.name;html+='" class="btn btn-block btn-primary btn-large" style="min-height:100px;padding-top:30px;background:';html+=cache['teambackground'];html+=';color:';html+=cache['teamfontcolor'];html+=';" href="';html+=value.url+'?teamid='+cache["teamid"];html+='">';
						html += value.name;
						html += 
							'      </a> ' +
							'    </p> ' + 
							'</div>';
					});

					html += '</div>';
					$('.pagelist').html(html);			
				})
			)				
		};
	
		//Public functions add here; Private otherwise
		return {
			init: init,
		};

	})();
	
	$(document).ready(function () {
		page.init();

	});	

</script>


    <div class="footer"></div>
  </div>  <!-- container -->  
</body>
</html>